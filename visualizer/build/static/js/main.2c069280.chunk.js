(this.webpackJsonpvisualizer=this.webpackJsonpvisualizer||[]).push([[0],{140:function(e){e.exports=JSON.parse('{"WEB_PATH":"https://gsoc2021-qa.nominatim.org/QA-data"}')},177:function(e,t,a){},178:function(e,t,a){},224:function(e,t,a){"use strict";a.r(t);var n=a(14),r=a.n(n),s=a(138),c=a.n(s),i=(a(177),a(45)),o=(a(178),a(102)),l=a.n(o),u=a(139),h=a(98),j=a.n(h),b=a(128),d=a(103),f=a(140),m=a.p+"static/media/arrow-right.33d644da.svg",p=a.p+"static/media/arrow-down.ec23fbbb.svg",g=a(148),O=a(9),y={description:"Description of the layer",why_problem:"Why are these data wrong",how_to_fix:"How to fix these errors"},v=function(e){var t=e.layerData,a=e.selectedLayer,r=e.setSelectedLayer,s=Object(n.useState)(!1),c=Object(i.a)(s,2),o=c[0],l=c[1];Object(n.useEffect)((function(){l(a&&a.id===t.id)}),[a]);var u=function(e){if(o&&e in t.doc){var a=e in y?y[e]:e;return Object(O.jsxs)("div",{children:[Object(O.jsxs)("p",{className:"layer-doc-title",children:[a,":"]}),Object(O.jsx)(g.a,{className:"layer-doc-content",linkTarget:"_blank",children:t.doc[e]})]})}return null};return Object(O.jsxs)("div",{className:"layer-wrapper ".concat(o?"layer-toggle":""),children:[Object(O.jsxs)("div",{className:"layer-title-arrow-wrapper",onClick:function(){return r(o?null:t)},children:[Object(O.jsx)("h3",{children:t.name}),Object(O.jsx)("div",{className:"flex-one"}),Object(O.jsx)("img",{className:"layer-arrow-icon",alt:"Reset city sort icon",src:o?p:m})]}),Object(O.jsxs)("div",{className:"layer-data-wrapper ".concat(o?"layer-data-toggle":""),children:[u("description"),u("why_problem"),u("how_to_fix")]})]})},x=a(145),w=a.n(x),k=function(e){var t=e.area,a=e.size,n=e.className,r=Object(d.usePromiseTracker)({area:t}).promiseInProgress;return Object(O.jsx)("div",{children:r&&Object(O.jsx)("div",{className:n,children:Object(O.jsx)(w.a,{type:"ThreeDots",color:"#82b9ff",height:a,width:a})})})},N=function(e){var t=e.selectedLayer,a=e.setSelectedLayer,r=Object(n.useState)([]),s=Object(i.a)(r,2),c=s[0],o=s[1];Object(n.useEffect)((function(){l()}),[]);var l=function(){var e=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.trackPromise)(h(),"layers-fetch");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(b.a)(j.a.mark((function e(){var t,a,n,r,s,c,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",cache:"no-cache"},e.next=3,fetch("".concat(f.WEB_PATH,"/layers.json"),t);case 3:return e.next=5,e.sent.json();case 5:if(a=e.sent,n=[],!a){e.next=31;break}r=Object(u.a)(a.layers),e.prev=9,r.s();case 11:if((s=r.n()).done){e.next=22;break}return c=s.value,e.next=15,fetch(c,t);case 15:return e.next=17,e.sent.json();case 17:(i=e.sent).id=a.layers.indexOf(c),n.push(i);case 20:e.next=11;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(9),r.e(e.t0);case 27:return e.prev=27,r.f(),e.finish(27);case 30:o(n);case 31:case"end":return e.stop()}}),e,null,[[9,24,27,30]])})));return function(){return e.apply(this,arguments)}}();return Object(O.jsxs)("div",{className:"layers-list-wrapper",children:[Object(O.jsx)(k,{size:60,area:"layers-fetch",className:"layers-loading-indicator"}),c.map((function(e){return Object(O.jsx)(v,{layerData:e,selectedLayer:t,setSelectedLayer:a},e.id)}))]})},S=a.p+"static/media/github.e0df113a.svg",F=a.p+"static/media/left-arrow.956c5d42.svg",P=function(e){var t=e.isMenuToggle,a=e.setMenuToggle,n=e.selectedLayer,r=e.setSelectedLayer;return Object(O.jsxs)("section",{className:"main-menu-wrapper ".concat(t?"":"not-toggle"),children:[Object(O.jsxs)("div",{className:"menu-title-wrapper",children:[Object(O.jsx)("h1",{children:"Nominatim QA"}),Object(O.jsx)("div",{className:"flex-one"}),Object(O.jsx)("img",{src:F,alt:"menu icon",className:"menu-icon",onClick:function(){return a(!t)}})]}),Object(O.jsx)("p",{className:"layers-label",children:"Layers:"}),Object(O.jsx)(o.Scrollbars,{autoHeight:!0,autoHeightMax:"100%",children:Object(O.jsx)(N,{selectedLayer:n,setSelectedLayer:r})}),Object(O.jsx)("div",{className:"flex-one"}),Object(O.jsxs)("div",{className:"github-wrapper",children:[Object(O.jsx)("img",{src:S,alt:"github icon"}),Object(O.jsx)("a",{href:"https://github.com/AntoJvlt/Nominatim-Data-Analyser",target:"_blank",rel:"noreferrer",children:"osm-search/Nominatim-Data-Analyser"})]})]})},_=(a(137),a(149)),L=a(150),T=a(155),C=a(121),z=a(34),A=a(58),D=a(70),E=a(74),M=a(122),H=a(233),I=a(151),R=a(231),B=a(88),J=a(130),W=a(232),Z=a(133),V=a(99),$=a(230),G=a.p+"static/media/location-pin.8a57e079.svg",Q=["geometry","layer"],Y=function(){function e(t,a,n){Object(z.a)(this,e),this.mediumSize=t,this.bigSize=a,this.getFeatureSize=n,this.textFill=new B.a({color:"#fff"}),this.greenFill=new B.a({color:"rgba(0,128,0,1)"}),this.orangeFill=new B.a({color:"rgba(255,128,0,1)"}),this.redFill=new B.a({color:"rgba(192,0,0,1)"}),this.singleIconStyle=new J.b({image:new W.a({src:G,scale:1.2})}),this.styleCache={}}return Object(A.a)(e,[{key:"getFillBySize",value:function(e){return e>this.bigSize?this.redFill:e>this.mediumSize?this.orangeFill:this.greenFill}},{key:"getStyle",value:function(e){var t=this.getFeatureSize(e),a=this.styleCache[t];if(!a)if(1===t)a=this.styleCache[t]=this.singleIconStyle;else{var n=t>this.bigSize?"192,0,0":t>this.mediumSize?"255,128,0":"0,128,0",r=Math.max(8,Math.min(.15*t,20)),s=[0,s=2*Math.PI*r/6,s,s,s,s,s];a=this.styleCache[t]=new J.b({image:new Z.a({radius:r,stroke:new V.a({color:"rgba("+n+",0.5)",width:15,lineDash:s,lineCap:"butt"}),fill:this.getFillBySize(t)}),text:new $.a({text:t.toString(),fill:this.textFill})})}return a}},{key:"onFeatureClick",value:function(e,t,a,n,r){}},{key:"getFeatureProperties",value:function(e){return{}}},{key:"constructPopupContent",value:function(e){var t=this.getFeatureProperties(e),a=/^[0-9]+$/,n="";for(var r in t)if(t.hasOwnProperty(r)){var s=t[r].toString();if(Q.includes(r))continue;if(("node_id"===r||"way_id"===r||"relation_id"===r||r.match("^[nwr]/@id"))&&s.match(a)){var c=r.charAt(0);if(r.match("^[nwr]/@id"))r=r.slice(5);else{var i=r.split("_");r=i[0].charAt(0).toUpperCase()+i[0].slice(1)+" "+i[1].toUpperCase()}s='<a target="_blank" href="https://www.openstreetmap.org/'+{n:"node",w:"way",r:"relation"}[c]+"/"+s+'">'+s+"</a>"}else"timestamp"===r&&(r="Timestamp",s=s.replace(/^([0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9])T([0-9][0-9]:[0-9][0-9]:[0-9][0-9])Z$/,"$1 $2"));n+="<p><span class='bold'>".concat(r,"</span>: ").concat(s,"</p>")}return n}}]),e}(),q=a(0),U=function(e){Object(D.a)(a,e);var t=Object(E.a)(a);function a(e){var n;Object(z.a)(this,a);return(n=t.call(this,8,25,(function(e){return e.get("features").length}))).source_url="geojson_url"in e?e.geojson_url:"",n}return Object(A.a)(a,[{key:"olLayer",get:function(){var e=this;return new H.a({source:new R.a({distance:80,source:new M.a({url:this.source_url+"?time="+(new Date).getTime(),format:new I.a})}),style:function(t){return e.getStyle(t)}})}},{key:"onFeatureClick",value:function(e,t,a,n,r){var s=e.get("features");if(s.length>1){var c=new q.j;s.forEach((function(e,t,a){Object(q.p)(c,e.getGeometry().getExtent())}));var i=a.getView().getResolutionForExtent(c),o=a.getView().getZoomForResolution(i),l=Object(q.w)(c);a.getView().animate({center:l,zoom:o,duration:1e3})}else r.current.innerHTML=this.constructPopupContent(e),n.setPosition(t)}},{key:"getFeatureProperties",value:function(e){return e.get("features")[0].getProperties()}}]),a}(Y),K=a(84),X=a(152),ee=a(153),te=a(146),ae=a(43),ne=function(e){Object(D.a)(a,e);var t=Object(E.a)(a);function a(e){var n;Object(z.a)(this,a);return(n=t.call(this,80,500,(function(e){return e.get("cluster")?e.get("point_count"):1}))).source_url="vector_tile_url"in e?e.vector_tile_url:"",n}return Object(A.a)(a,[{key:"olLayer",get:function(){var e=this;return new X.a({source:new ee.a({format:new te.a({featureClass:K.a}),tileGrid:new ae.b({maxZoom:15}),url:this.source_url+"?time="+(new Date).getTime()}),style:function(t){return e.getStyle(t)}})}},{key:"onFeatureClick",value:function(e,t,a,n,r){e.get("cluster")?a.getView().animate({center:t,zoom:e.get("clusterExpansionZoom"),duration:1e3}):(r.current.innerHTML=this.constructPopupContent(e),n.setPosition(t))}},{key:"getFeatureProperties",value:function(e){return e.getProperties()}}]),a}(Y),re=function(){function e(){Object(z.a)(this,e)}return Object(A.a)(e,null,[{key:"constructFeaturesLayer",value:function(e){return"geojson_url"in e?new U(e):new ne(e)}}]),e}(),se=a(82),ce=a(154),ie=a.p+"static/media/cross.fa7e5ead.svg",oe=function(e){var t=e.selectedLayer,a=Object(n.useState)(),r=Object(i.a)(a,2),s=r[0],c=r[1],o=Object(n.useState)(null),l=Object(i.a)(o,2),u=l[0],h=l[1],j=Object(n.useState)(null),b=Object(i.a)(j,2),d=b[0],f=b[1],m=Object(n.useState)(null),p=Object(i.a)(m,2),g=p[0],y=p[1],v=Object(n.useState)(null),x=Object(i.a)(v,2),w=x[0],k=x[1],N=Object(n.useRef)(),S=Object(n.useRef)(),F=Object(n.useRef)(),P=Object(n.useRef)();Object(n.useEffect)((function(){var e=new ce.a({element:S.current,autoPan:!0,autoPanAnimation:{duration:250}});y(e);var t=new _.a({layers:[new T.a({source:new L.a})],overlays:[e],target:N.current,view:new C.a({center:[0,0],zoom:1,minZoom:1})});c(t),F.current.onclick=function(){return e.setPosition(void 0),!1}}),[]),Object(n.useEffect)((function(){if(s&&(u&&(s.removeLayer(u),h(null),f(null)),g.setPosition(void 0),t)){var e=re.constructFeaturesLayer(t);f(e);var a=re.constructFeaturesLayer(t).olLayer;h(a),s.addLayer(a)}}),[t]),Object(n.useEffect)((function(){s&&d&&(w&&Object(se.b)(w),k(s.on(["click"],z)))}),[d]);var z=function(e){var t=!1;s&&(g.setPosition(void 0),s.forEachFeatureAtPixel(e.pixel,(function(a){t||(t=!0,d.onFeatureClick(a,e.coordinate,s,g,P))}),{hitTolerance:3}))};return Object(O.jsxs)("div",{className:"map-container",children:[Object(O.jsx)("section",{ref:N,id:"map"}),Object(O.jsxs)("div",{ref:S,className:"ol-popup",children:[Object(O.jsxs)("div",{className:"popup-header",children:[Object(O.jsx)("p",{children:"Properties"}),Object(O.jsx)("div",{className:"flex-one"}),Object(O.jsx)("img",{src:ie,alt:"close icon popup",ref:F,className:"ol-popup-close-icon"})]}),Object(O.jsx)("div",{ref:P,className:"ol-popup-content"})]})]})},le=a.p+"static/media/menu.b088df50.svg",ue=a(56),he=function(e){var t=e.setInfoPanelDisplayed;return Object(O.jsx)("section",{className:"information-panel",children:Object(O.jsxs)(l.a,{autoHeight:!0,autoHeightMax:"100%",renderTrackHorizontal:function(e){return Object(O.jsx)("div",Object(ue.a)(Object(ue.a)({},e),{},{style:{display:"none"},className:"track-horizontal"}))},children:[Object(O.jsxs)("div",{className:"information-panel-title-wrapper",children:[Object(O.jsxs)("h2",{children:["Welcome to the ",Object(O.jsx)("span",{className:"blue-text",children:"Nominatim QA"})," Tool!"]}),Object(O.jsx)("div",{className:"flex-one"}),Object(O.jsx)("button",{className:"information-panel-close-button",onClick:function(){return t(!1)},children:Object(O.jsx)("img",{src:ie,alt:"close icon",className:"information-panel-close-icon"})})]}),Object(O.jsxs)("p",{children:["This tool helps to improve the OpenStreetMap data quality by extracting suspect data from the ",Object(O.jsx)("a",{href:"https://nominatim.org/",target:"_blank",rel:"noreferrer",children:"Nominatim"})," database. You can contribute to the development of this tool through the ",Object(O.jsx)("a",{href:"https://github.com/AntoJvlt/Nominatim-Data-Analyser",target:"_blank",rel:"noreferrer",children:"github repository"}),"."]}),Object(O.jsx)("p",{children:"The suspect data are distributed among multiple layers. You can find these layers in the menu on the left of your screen. Feel free to check the data and to correct them if you live near some of them!"}),Object(O.jsxs)("p",{children:['We do not have a "report false positive" feature implemented yet. If you find a lot of data which should not be considered as errors, please come to the "Issues" section of the ',Object(O.jsx)("a",{href:"https://github.com/AntoJvlt/Nominatim-Data-Analyser/issues",target:"_blank",rel:"noreferrer",children:"github repository"})," to discuss this."]}),Object(O.jsx)("p",{className:"italic-text",children:"/!\\ You might encounter some performance issues with some layers if you are using the Firefox browser. Please switch of browser if this is the case. /!\\"})]})})};var je=function(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),a=t[0],r=t[1],s=Object(n.useState)(!0),c=Object(i.a)(s,2),o=c[0],l=c[1],u=Object(n.useState)(!0),h=Object(i.a)(u,2),j=h[0],b=h[1];return Object(O.jsxs)("div",{className:"app",children:[Object(O.jsx)(P,{isMenuToggle:o,setMenuToggle:l,selectedLayer:a,setSelectedLayer:r}),Object(O.jsx)(oe,{selectedLayer:a}),j&&Object(O.jsx)(he,{setInfoPanelDisplayed:b}),!o&&Object(O.jsx)("div",{className:"absolute-menu-icon-wrapper",children:Object(O.jsx)("img",{src:le,alt:"menu icon",className:"menu-icon absolute-menu-icon",onClick:function(){return l(!o)}})})]})},be=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,234)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),s(e),c(e)}))};c.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(je,{})}),document.getElementById("root")),be()}},[[224,1,2]]]);
//# sourceMappingURL=main.2c069280.chunk.js.map