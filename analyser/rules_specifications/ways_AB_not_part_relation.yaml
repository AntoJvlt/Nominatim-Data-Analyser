---
QUERY:
  type: SQLProcessor
  query: >
    SELECT ST_AsText(centroid), osm_id FROM placex AS px WHERE osm_type='W' AND class='boundary' AND type='administrative' AND
    NOT EXISTS(SELECT 1 FROM planet_osm_rels WHERE id = (SELECT osm_id FROM placex WHERE place_id=px.parent_place_id)
    AND cardinality(array_positions(members, concat(lower(px.type), px.osm_id))) >= 1);
  results_types:
    - Node
  out:
    CONVERTER:
      type: GeoJSONFeatureConverter
      properties:
        way_id: $osm_id
      out:
        GEOJSON:
          type: GeoJSONFormatter
          file_name: ABWaysNotPartOfRelation
          out:
            VECTOR_TILE_CONVERTER:
              type: VectorTileConverter
              folder_name: ABWaysNotPartOfRelation
              out:
                LAYER_FILE:
                  type: LayerFormatter
                  file_name: ABWaysNotPartOfRelation
                  data_format_url: vector_tile_url
                  name: AB ways not part of a relation
                  updates: Every evening
                  doc:
                    description: Ways with boundary=administrative that are not part of a relation.
                    how_to_fix: Check that the way is well defined.